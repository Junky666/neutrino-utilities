import pywaves as pw
import base64
import time

pw.setNode('http://localhost:6869', chain='mainnet')
myAddress = pw.Address(privateKey='my_node_private_key')
beneficiaryAddressStr58 = '3P_your_beneficiary_address'
setFee = 3 * pw.DEFAULT_SCRIPT_FEE # current script size is 2008 bytes, which is rounded to 3k and results in 0.003 fee
script = 'base64:BgIHCAISAwoBCAgAA1NFUAICX18ABU1VTFQ4AIDC1y8BFWtleUJlbmVmaWNpYXJ5QWRkcmVzcwACHSVzJXNfX2NmZ19fYmVuZWZpY2lhcnlBZGRyZXNzARZrZXlDb25zdHJ1Y3RvckludGVydmFsAAIhJXMlc19fY2ZnX19ub2RlQ29udHJ1Y3RvckludGVydmFsARNrZXlMYXN0VXBkYXRlSGVpZ2h0AAIVJXNfX2xhc3RVcGRhdGVkSGVpZ2h0ARNrZXlTY3JpcHRVcGRhdGVIYXNoAAIdJXMlc19fbWluZXJfX3NjcmlwdFVwZGF0ZUhhc2gBGGtleVNjcmlwdFVwZGF0ZUFsbG93YW5jZQACIiVzJXNfX21pbmVyX19zY3JpcHRVcGRhdGVBbGxvd2FuY2UADG5vZGVSZWdpc3RyeQkBEUBleHRyTmF0aXZlKDEwNjIpAQIjM1A5dktxUUtqVWRtcFhBZmlXYXU4a3JSRVlBWTFYcjY5cEUBAWkBC2NvbnN0cnVjdG9yARdiZW5lZmljaWFyeUFkZHJlc3NTdHI1OAMJAQIhPQIFBHRoaXMIBQFpBmNhbGxlcgkAAgECEnBlcm1pc3Npb25zIGRlbmllZAQSYmVuZWZpY2lhcnlBZGRyZXNzCQERQGV4dHJOYXRpdmUoMTA2MikBBRdiZW5lZmljaWFyeUFkZHJlc3NTdHI1OAMJAAACBRJiZW5lZmljaWFyeUFkZHJlc3MFBHRoaXMJAAIBAjptaW5pbmcgbm9kZSBhZGRyZXNzIGlzIG5vdCBhbGxvd2VkIGFzIGEgYmVuZWZpY2lhcnlBZGRyZXNzCQDMCAIJAQtTdHJpbmdFbnRyeQIJARVrZXlCZW5lZmljaWFyeUFkZHJlc3MACQClCAEFEmJlbmVmaWNpYXJ5QWRkcmVzcwkAzAgCCQEMSW50ZWdlckVudHJ5AgkBE2tleUxhc3RVcGRhdGVIZWlnaHQABQZoZWlnaHQFA25pbAECdHgBBnZlcmlmeQAEByRtYXRjaDAFAnR4AwkAAQIFByRtYXRjaDACF0ludm9rZVNjcmlwdFRyYW5zYWN0aW9uBANpbnYFByRtYXRjaDADCQBmAggFA2ludgNmZWUJAGkCCQBoAgAFBQVNVUxUOADoBwkAAgEJAKwCAgJCSW52b2tlU2NyaXB0VHJhbnNhY3Rpb24gLSBmZWUgYW1vdW50IGlzIGdyZWF0ZXIgdGhhbiBtYXggYWxsb3dlZDogCQCkAwEIBQNpbnYDZmVlAwkBCWlzRGVmaW5lZAEIBQNpbnYKZmVlQXNzZXRJZAkAAgECPUludm9rZVNjcmlwdFRyYW5zYWN0aW9uIC0gb25seSBXQVZFUyBpcyBhbGxvd2VkIGFzIGZlZUFzc2V0SWQDCQAAAgkApAgBCAUDaW52BGRBcHAFDG5vZGVSZWdpc3RyeQYDCQAAAgkApAgBCAUDaW52BGRBcHAFBHRoaXMEEWxhc3RVcGRhdGVkSGVpZ2h0CQELdmFsdWVPckVsc2UCCQCaCAIFBHRoaXMJARNrZXlMYXN0VXBkYXRlSGVpZ2h0AAAABA5jb25zdHJJbnRlcnZhbAkBC3ZhbHVlT3JFbHNlAgkAmggCBQxub2RlUmVnaXN0cnkJARZrZXlDb25zdHJ1Y3RvckludGVydmFsAADgTgMJAGYCBQ5jb25zdHJJbnRlcnZhbAkAZQIFBmhlaWdodAURbGFzdFVwZGF0ZWRIZWlnaHQJAAIBAkNJbnZva2VTY3JpcHRUcmFuc2FjdGlvbiAtIGltcG9zc2libGUgdG8gY2FsbCBjb25zdHJ1Y3RvciB2ZXJ5IG9mdGVuCQDGEwMIBQJ0eAlib2R5Qnl0ZXMJAJEDAggFAnR4BnByb29mcwAACAUCdHgPc2VuZGVyUHVibGljS2V5CQACAQIuSW52b2tlU2NyaXB0VHJhbnNhY3Rpb24gLSBpbnZhbGlkIGRhcHAgYWRkcmVzcwMJAAECBQckbWF0Y2gwAhRTZXRTY3JpcHRUcmFuc2FjdGlvbgQDc3R4BQckbWF0Y2gwAwkAZgIIBQNzdHgDZmVlCQBpAgkAaAIAAgUFTVVMVDgAZAkAAgEJAKwCAgI/U2V0U2NyaXB0VHJhbnNhY3Rpb24gLSBmZWUgYW1vdW50IGlzIGdyZWF0ZXIgdGhhbiBtYXggYWxsb3dlZDogCQCkAwEIBQNzdHgDZmVlBAtzY3JpcHRCeXRlcwkBBXZhbHVlAQgFA3N0eAZzY3JpcHQEBGhhc2gJANgEAQkA8RUBBQtzY3JpcHRCeXRlcwQLYWxsb3dlZEhhc2gJAQt2YWx1ZU9yRWxzZQIJAJ0IAgUMbm9kZVJlZ2lzdHJ5CQETa2V5U2NyaXB0VXBkYXRlSGFzaAACAAQLdmFsaWRCeUhhc2gDCQECIT0CBQthbGxvd2VkSGFzaAIACQAAAgULYWxsb3dlZEhhc2gFBGhhc2gHBA1hbGxvd1RvVXBkYXRlCQELdmFsdWVPckVsc2UCCQCbCAIFDG5vZGVSZWdpc3RyeQkBGGtleVNjcmlwdFVwZGF0ZUFsbG93YW5jZQAHAwUNYWxsb3dUb1VwZGF0ZQULdmFsaWRCeUhhc2gHCQACAQILbm90IGFsbG93ZWTcf3jp'
scriptSource = base64.b64decode(script)
result = myAddress.setScript(scriptSource, txFee=setFee)
print(result)

print('Waiting for transaction to finalize...')
time.sleep(30)

callFee = pw.DEFAULT_INVOKE_SCRIPT_FEE + pw.DEFAULT_SMART_FEE
result = myAddress.invokeScript(myAddress.address, 'constructor', params=[{"type": "string", "value": beneficiaryAddressStr58}], payments=[], feeAsset = None, txFee=callFee)
print(result)
