import pywaves as pw
import base64
import time

pw.setNode('http://localhost:6869', chain='mainnet')
myAddress = pw.Address(privateKey='my_node_private_key')
beneficiaryAddressStr58 = '3P_your_beneficiary_address'
setFee = 3 * pw.DEFAULT_SCRIPT_FEE # current script size is 2008 bytes, which is rounded to 3k and results in 0.003 fee
script = 'base64:BgIHCAISAwoBCAgAA1NFUAICX18ABU1VTFQ4AIDC1y8BFWtleUJlbmVmaWNpYXJ5QWRkcmVzcwACHSVzJXNfX2NmZ19fYmVuZWZpY2lhcnlBZGRyZXNzARZrZXlDb25zdHJ1Y3RvckludGVydmFsAAIhJXMlc19fY2ZnX19ub2RlQ29udHJ1Y3RvckludGVydmFsARNrZXlMYXN0VXBkYXRlSGVpZ2h0AAIVJXNfX2xhc3RVcGRhdGVkSGVpZ2h0ARNrZXlTY3JpcHRVcGRhdGVIYXNoAAIdJXMlc19fbWluZXJfX3NjcmlwdFVwZGF0ZUhhc2gBGGtleVNjcmlwdFVwZGF0ZUFsbG93YW5jZQACIiVzJXNfX21pbmVyX19zY3JpcHRVcGRhdGVBbGxvd2FuY2UADG5vZGVSZWdpc3RyeQkBEUBleHRyTmF0aXZlKDEwNjIpAQIjM1A5dktxUUtqVWRtcFhBZmlXYXU4a3JSRVlBWTFYcjY5cEUBAWkBC2NvbnN0cnVjdG9yARdiZW5lZmljaWFyeUFkZHJlc3NTdHI1OAMJAQIhPQIFBHRoaXMIBQFpBmNhbGxlcgkAAgECEnBlcm1pc3Npb25zIGRlbmllZAQSYmVuZWZpY2lhcnlBZGRyZXNzCQERQGV4dHJOYXRpdmUoMTA2MikBBRdiZW5lZmljaWFyeUFkZHJlc3NTdHI1OAMJAAACBRJiZW5lZmljaWFyeUFkZHJlc3MFBHRoaXMJAAIBAjptaW5pbmcgbm9kZSBhZGRyZXNzIGlzIG5vdCBhbGxvd2VkIGFzIGEgYmVuZWZpY2lhcnlBZGRyZXNzCQDMCAIJAQtTdHJpbmdFbnRyeQIJARVrZXlCZW5lZmljaWFyeUFkZHJlc3MACQClCAEFEmJlbmVmaWNpYXJ5QWRkcmVzcwkAzAgCCQEMSW50ZWdlckVudHJ5AgkBE2tleUxhc3RVcGRhdGVIZWlnaHQABQZoZWlnaHQFA25pbAECdHgBBnZlcmlmeQAEByRtYXRjaDAFAnR4AwkAAQIFByRtYXRjaDACF0ludm9rZVNjcmlwdFRyYW5zYWN0aW9uBANpbnYFByRtYXRjaDADCQBmAggFA2ludgNmZWUJAGkCCQBoAgAFBQVNVUxUOADoBwkAAgEJAKwCAgJCSW52b2tlU2NyaXB0VHJhbnNhY3Rpb24gLSBmZWUgYW1vdW50IGlzIGdyZWF0ZXIgdGhhbiBtYXggYWxsb3dlZDogCQCkAwEIBQNpbnYDZmVlAwkBCWlzRGVmaW5lZAEIBQNpbnYKZmVlQXNzZXRJZAkAAgECPUludm9rZVNjcmlwdFRyYW5zYWN0aW9uIC0gb25seSBXQVZFUyBpcyBhbGxvd2VkIGFzIGZlZUFzc2V0SWQDCQAAAgkApAgBCAUDaW52BGRBcHAFDG5vZGVSZWdpc3RyeQYDCQAAAgkApAgBCAUDaW52BGRBcHAFBHRoaXMEEWxhc3RVcGRhdGVkSGVpZ2h0CQELdmFsdWVPckVsc2UCCQCaCAIFBHRoaXMJARNrZXlMYXN0VXBkYXRlSGVpZ2h0AAAABA5jb25zdHJJbnRlcnZhbAkBC3ZhbHVlT3JFbHNlAgkAmggCBQxub2RlUmVnaXN0cnkJARZrZXlDb25zdHJ1Y3RvckludGVydmFsAADA0QIDCQBmAgUOY29uc3RySW50ZXJ2YWwJAGUCBQZoZWlnaHQFEWxhc3RVcGRhdGVkSGVpZ2h0CQACAQJDSW52b2tlU2NyaXB0VHJhbnNhY3Rpb24gLSBpbXBvc3NpYmxlIHRvIGNhbGwgY29uc3RydWN0b3IgdmVyeSBvZnRlbgkAxhMDCAUCdHgJYm9keUJ5dGVzCQCRAwIIBQJ0eAZwcm9vZnMAAAgFAnR4D3NlbmRlclB1YmxpY0tleQkAAgECLkludm9rZVNjcmlwdFRyYW5zYWN0aW9uIC0gaW52YWxpZCBkYXBwIGFkZHJlc3MDCQABAgUHJG1hdGNoMAIUU2V0U2NyaXB0VHJhbnNhY3Rpb24EA3N0eAUHJG1hdGNoMAMJAGYCCAUDc3R4A2ZlZQkAaQIJAGgCAAIFBU1VTFQ4AGQJAAIBCQCsAgICP1NldFNjcmlwdFRyYW5zYWN0aW9uIC0gZmVlIGFtb3VudCBpcyBncmVhdGVyIHRoYW4gbWF4IGFsbG93ZWQ6IAkApAMBCAUDc3R4A2ZlZQQLc2NyaXB0Qnl0ZXMJAQV2YWx1ZQEIBQNzdHgGc2NyaXB0BARoYXNoCQDYBAEJAPEVAQULc2NyaXB0Qnl0ZXMEC2FsbG93ZWRIYXNoCQELdmFsdWVPckVsc2UCCQCdCAIFDG5vZGVSZWdpc3RyeQkBE2tleVNjcmlwdFVwZGF0ZUhhc2gAAgAEC3ZhbGlkQnlIYXNoAwkBAiE9AgULYWxsb3dlZEhhc2gCAAkAAAIFC2FsbG93ZWRIYXNoBQRoYXNoBwQNYWxsb3dUb1VwZGF0ZQkBC3ZhbHVlT3JFbHNlAgkAmwgCBQxub2RlUmVnaXN0cnkJARhrZXlTY3JpcHRVcGRhdGVBbGxvd2FuY2UABwMFDWFsbG93VG9VcGRhdGUFC3ZhbGlkQnlIYXNoBwkAAgECC25vdCBhbGxvd2VkFh3GIg=='
scriptSource = base64.b64decode(script)
result = myAddress.setScript(scriptSource, txFee=setFee)
print(result)

print('Waiting for transaction to finalize...')
time.sleep(30)

callFee = pw.DEFAULT_INVOKE_SCRIPT_FEE + pw.DEFAULT_SMART_FEE
result = myAddress.invokeScript(myAddress.address, 'constructor', params=[{"type": "string", "value": beneficiaryAddressStr58}], payments=[], feeAsset = None, txFee=callFee)
print(result)
